@model SCUTClubManager.Models.Thread

@{
    ViewBag.Title = "Details";
}

<script>
    $(document).ready(function () {
        $("#btPostReply").click(function () {

            var replyText = $("#replyText").val();

            $.ajax({
                type: "POST",
                url: "Forum",
                contentType: "application/json; charset=utf-8",
                data: JSON.stringify({ id: "@Model.Id", reply: replyText }),
                dataType: "json",
                success: function (data) {
                    if (data.success ) {
                        document.location = "/Forum/Details/@Model.Id";
                    }
                    else {
                        $("#replyErrorMsg").text(data.msg);
                    }
                }
            })
        })
    })
</script>

<h2>留言板</h2>


@using (Html.BeginForm())
{
<h2>@Model.Title</h2>

    foreach (var reply in Model.Replies)
    {
        <fieldset class="ThreadReply">
            <legend>@reply.Number 楼</legend>

            <div class="display-field">
                <b>标题:</b>
                <span>@Html.DisplayFor(model => model.Title)</span>
            </div>

            <div class="display-field">
                <b>作者:</b>
                <span>@reply.Author.Name</span>
            </div>

            <div>
                <b>内容:</b>
            </div>
            <div class="display-field">
                <span>@reply.Content</span>
            </div>
        </fieldset>
    }
    
    <input type="hidden" name="id" value="@Model.Id" />


    
    <div>
        <textarea id="replyText" name="replyText" style="height: 175px"></textarea>
        <p id="replyErrorMsg"></p>
    </div>

    
        <button id="btPostReply"  type="button">回复</button>
        @Html.ActionLink("返回", "Index")
}